ff -H
foo
bar
baz
dir
dir/dir
dir/dir/empty
dir/empty_dir



ff type=d
dir
dir/dir
dir/empty_dir



ff -H type=f
foo
baz
dir/dir/empty



ff type=f
foo
baz
dir/dir/empty
.hidden



ff type=l
bar



ff name%ba?
bar
baz



ff -H empty=yes
dir/empty_dir
dir/dir/empty



ff -H empty=yes OR type=l
dir/empty_dir
dir/dir/empty
bar



ff empty=no
foo
bar
baz
dir
dir/dir



ff -H depth=0
foo
bar
baz
dir



ff depth+=1
dir/dir
dir/dir/empty
dir/empty_dir



ff -H size=0
bar
dir/dir/empty
dir
dir/dir
dir/empty_dir



ff size+0
foo
baz



ff size+=10
baz



ff -H -o perm:o,size:o,name not type=d depth=0
777 0 bar
644 4 foo
644 12 baz



# keep_order
ff -H -S
bar
baz
dir
dir/dir
dir/dir/empty
dir/empty_dir
foo



ff -H -S -R
foo
dir/empty_dir
dir/dir/empty
dir/dir
dir
baz
bar



ff -H -S size type=f
dir/dir/empty
foo
baz



ff -H -S -1
bar



ff -S -R -l 5
foo
dir/empty_dir
dir/dir/empty
dir/dir
dir



# no_order
ff -H -o mode:h,links,size:5h,path:h
lrwxrwxrwx 1     0 bar -> foo
-rw-r--r-- 1     4 foo
-rw-r--r-- 1    10 baz
drwxr-xr-x 4     0 dir
-rw-r--r-- 1     0 dir/dir/empty
drwxr-xr-x 2     0 dir/empty_dir
drwxr-xr-x 2     0 dir/dir



ff -H -o size,links,path --sep :
0:1:bar
4:1:foo
10:1:baz
0:4:dir
0:1:dir/dir/empty
0:2:dir/empty_dir
0:2:dir/dir



# Test sub testsequences and operators.
ff type=f \( name=baz or name=foo \)
foo
baz


ff \( name=bar or name=foo \) \( type=l or type=f \)
foo
bar


ff \( name=baz or name=foo \) type=f or type=l
foo
bar
baz


ff \( path:/dir/ type=f \) or \( name=dir type=d \)
dir
dir/dir
dir/dir/empty


ff -H {{ type=f and not type=l }}
foo
baz
dir/dir/empty


ff -H type=f and not {{ name=baz or name=empty }}
foo


ff -H type=f and {{ not name=baz and not name=empty }}
foo


# usage
( cd ..; ff -H workdir/ type=f and {{ not name=baz and not name=empty }} )
workdir/foo

( cd ..; ff type=f workdir/ and {{ not name=baz and not name=empty }} )

( cd ..; ff type=f and {{ not name=baz workdir/ and not name=empty }} )

( cd ..; ff -H type=f and {{ not name=baz and not name=empty }} workdir/ )
workdir/foo

# --glob, --fixed-strings, --regex
ff -g 'ba?'
bar
baz

ff -F 'ba?'

ff -p -F dir/empty
dir/dir/empty
dir/empty_dir

ff --regex 'ba.'
bar
baz


# JSON
ff -H --json -o name,size type=f -S name
[{"name": "baz", "size": 10},{"name": "empty", "size": 0},{"name": "foo", "size": 4}]



ff -H --jsonl -o name,size type=f -S name
{"name": "baz", "size": 10}
{"name": "empty", "size": 0}
{"name": "foo", "size": 4}



# Counts
ff -H --count size type=f
file.size=14
_total=3



ff -H --count type
file.type[directory]=3
file.type[file]=3
file.type[symlink]=1
_total=7



ff -H --count size,type --json
{"_total": 7, "file.size": 14, "file.type": {"directory": 3, "file": 3, "symlink": 1}}



# Regression testing

# Check if sort using a missing field works.
ff -H -S duration
foo
bar
baz
dir
dir/dir
dir/dir/empty
dir/empty_dir
